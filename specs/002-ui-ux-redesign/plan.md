# Implementation Plan: UI/UX Premium Redesign

**Branch**: `002-ui-ux-redesign` | **Date**: 2026-01-30 | **Spec**: [spec.md](./spec.md)
**Input**: Feature specification for complete UI/UX overhaul with premium Fluent Design aesthetics

## Summary

Transform ReqChecker from a basic WPF application into a world-class enterprise tool with:
- WPF-UI FluentWindow with Mica backdrop
- Collapsible sidebar navigation (72px/240px)
- Premium dark/light themes with smooth transitions
- Animated progress ring and micro-interactions
- Card-based layouts with elevation system
- Full accessibility support (keyboard, reduced motion, screen readers)

## Technical Context

**Language/Version**: C# 12 / .NET 8.0 LTS
**Primary Dependencies**: WPF-UI 4.2.0, CommunityToolkit.Mvvm 8.4.0
**Storage**: %APPDATA%/ReqChecker/preferences.json (user preferences)
**Testing**: xUnit with coverlet
**Target Platform**: Windows 10/11 desktop (x64)
**Project Type**: Single WPF desktop application
**Performance Goals**: 60fps animations, <100ms UI response
**Constraints**: WCAG AA contrast, keyboard navigation, reduced motion support
**Scale/Scope**: 7 views to redesign, ~15 new/modified resource files, ~3 new custom controls

## Constitution Check

*GATE: No constitution defined - proceeding with standard best practices*

- [x] No excessive abstraction layers
- [x] No unnecessary dependencies (using existing WPF-UI)
- [x] Clear separation of concerns (MVVM pattern maintained)
- [x] Testable components (ViewModels remain unit-testable)

## Project Structure

### Documentation (this feature)

```text
specs/002-ui-ux-redesign/
├── plan.md              # This file
├── spec.md              # Feature specification
├── research.md          # Technical decisions
├── data-model.md        # UI state entities
├── design-system.md     # Design tokens reference
├── visual-mockups.md    # View layouts
├── quickstart.md        # Implementation guide
├── contracts/
│   ├── preferences-schema.json   # User preferences format
│   └── design-tokens.json        # Design token definitions
└── tasks.md             # (generated by /speckit.tasks)
```

### Source Code (repository root)

```text
src/ReqChecker.App/
├── App.xaml                    # Resource dictionary merging (MODIFY)
├── MainWindow.xaml             # FluentWindow with NavigationView (MODIFY)
├── MainWindow.xaml.cs          # Navigation logic (MODIFY)
├── Controls/
│   ├── TestStatusBadge.xaml    # Add glow effects (MODIFY)
│   ├── ProgressRing.xaml       # Gradient stroke (MODIFY)
│   ├── LockedFieldControl.xaml # Style updates (MODIFY)
│   ├── ExpanderCard.xaml       # NEW - expandable result cards
│   └── SummaryCard.xaml        # NEW - stats dashboard cards
├── Resources/
│   └── Styles/
│       ├── Theme.xaml          # REPLACE with modular system
│       ├── Colors.Dark.xaml    # NEW - dark theme colors
│       ├── Colors.Light.xaml   # NEW - light theme colors
│       ├── Typography.xaml     # NEW - font styles
│       ├── Spacing.xaml        # NEW - spacing values
│       ├── Animations.xaml     # NEW - storyboard templates
│       └── Controls.xaml       # NEW - control style overrides
├── Services/
│   ├── ThemeService.cs         # Enhance with persistence (MODIFY)
│   └── PreferencesService.cs   # NEW - user preferences
├── ViewModels/
│   └── MainWindowViewModel.cs  # Add sidebar state (MODIFY)
└── Views/
    ├── ProfileSelectorView.xaml    # Redesign (MODIFY)
    ├── TestListView.xaml           # Redesign (MODIFY)
    ├── TestConfigView.xaml         # Redesign (MODIFY)
    ├── RunProgressView.xaml        # Redesign (MODIFY)
    ├── ResultsView.xaml            # Redesign (MODIFY)
    ├── DiagnosticsView.xaml        # Redesign (MODIFY)
    └── CredentialPromptDialog.xaml # Redesign (MODIFY)

tests/ReqChecker.App.Tests/
├── Services/
│   ├── ThemeServiceTests.cs        # NEW
│   └── PreferencesServiceTests.cs  # NEW
└── ViewModels/
    └── MainWindowViewModelTests.cs # Extend for sidebar state
```

**Structure Decision**: Existing single-project structure maintained. New resource files added under `Resources/Styles/`. New services for preferences and enhanced theming.

## Implementation Phases

### Phase 1: Theme Infrastructure (Foundation)

**Goal**: Establish the design token system and theme switching mechanism

**Tasks**:
1. Create `Colors.Dark.xaml` with all dark theme color tokens
2. Create `Colors.Light.xaml` with all light theme color tokens
3. Create `Typography.xaml` with font styles
4. Create `Spacing.xaml` with spacing values
5. Create `PreferencesService.cs` for persisting user preferences
6. Enhance `ThemeService.cs` to use new resource dictionaries and persist theme choice
7. Update `App.xaml` to merge resource dictionaries properly
8. Add unit tests for PreferencesService and ThemeService

**Verification**: Theme can be toggled and persists across app restarts

### Phase 2: Main Window Shell (Navigation)

**Goal**: Replace header navigation with sidebar FluentWindow layout

**Tasks**:
1. Convert `MainWindow` base class to `FluentWindow`
2. Replace header navigation with `NavigationView` sidebar
3. Add sidebar collapse/expand toggle with persistence
4. Implement Mica backdrop for title bar (Win11) with fallback
5. Add status bar with version, profile name, theme toggle
6. Update `MainWindowViewModel` with `IsSidebarExpanded` property
7. Implement view transitions with fade animation

**Verification**: Sidebar navigates between views, collapses/expands, state persists

### Phase 3: Core Components (Reusable Controls)

**Goal**: Create/enhance reusable UI components with premium styling

**Tasks**:
1. Create button styles (Primary with gradient, Secondary, Ghost)
2. Create card base style with elevation and hover effects
3. Enhance `TestStatusBadge` with glow effects
4. Enhance `ProgressRing` with gradient stroke
5. Create `ExpanderCard` control for expandable content
6. Create `SummaryCard` control for stats display
7. Create `Animations.xaml` with reusable storyboard templates
8. Add reduced motion detection and conditional animation logic

**Verification**: Components render correctly in both themes, animations smooth

### Phase 4: View Redesigns (Apply Design System)

**Goal**: Apply new design system to all views

**Subphase 4a - Profile Selector View**:
- Large profile cards with gradient header strips
- Empty state with Fluent icon composition
- Import button with drag-drop styling

**Subphase 4b - Test List View**:
- Interactive test cards with type icons
- Run All Tests button with gradient accent
- Staggered entrance animations

**Subphase 4c - Run Progress View**:
- Centered 120px progress ring
- Current test card with pulse animation
- Completed tests mini-list

**Subphase 4d - Results View**:
- Summary dashboard with stats cards
- Donut chart for pass/fail/skip ratio
- Filter tabs (All/Passed/Failed/Skipped)
- Expandable result cards

**Subphase 4e - Other Views**:
- Test Config View with locked field indicators
- Diagnostics View with key-value cards
- Credential Prompt Dialog restyling

**Verification**: Each view matches design mockups, animations work

### Phase 5: Accessibility & Polish

**Goal**: Ensure accessibility compliance and final polish

**Tasks**:
1. Implement custom focus ring style (accent-colored)
2. Verify keyboard navigation for all interactive elements
3. Add screen reader announcements for navigation and status changes
4. Verify WCAG AA contrast ratios for all text
5. Test reduced motion setting respects all animations
6. Test high DPI rendering (100%, 125%, 150%, 200%)
7. Test Windows 10 fallback (no Mica, solid colors)
8. Performance profiling for 60fps animations

**Verification**: All accessibility requirements pass, no visual regressions

## Key Technical Decisions

| Decision | Choice | Rationale |
|----------|--------|-----------|
| Window base class | FluentWindow | Native Mica support, snap layouts, accessibility |
| Navigation | WPF-UI NavigationView | Built-in collapse, icons, keyboard nav |
| Theme persistence | JSON in %APPDATA% | Lightweight, no registry, single-file publish compatible |
| Animations | WPF Storyboards | Native, no dependencies, conditional disable |
| Progress ring | Custom control | Gradient stroke not in WPF-UI default |
| Donut chart | Custom Path drawing | Avoid heavy charting library dependency |
| Reduced motion | SystemParameters.ClientAreaAnimation | Built-in WPF API |

## Dependencies Between Phases

```
Phase 1 (Theme Infrastructure)
    ↓
Phase 2 (Main Window Shell) ← depends on theme colors
    ↓
Phase 3 (Core Components) ← depends on shell for testing
    ↓
Phase 4 (View Redesigns) ← depends on all components
    ↓
Phase 5 (Accessibility & Polish) ← depends on all views complete
```

## Risk Mitigation

| Risk | Mitigation |
|------|------------|
| Mica not working | Fallback to solid color tested early in Phase 2 |
| Animation performance | Use RenderTransform, avoid Margin animations |
| Theme switch layout shift | Use DynamicResource, test transitions |
| Accessibility regression | Keyboard test each phase, not just Phase 5 |

## Success Criteria Mapping

| Criteria | Verification |
|----------|--------------|
| SC-001: DPI consistency | Phase 5 high DPI testing |
| SC-002: 60fps animations | Phase 5 performance profiling |
| SC-003: Theme persistence | Phase 1 unit tests |
| SC-004: Keyboard navigation | Phase 5 accessibility testing |
| SC-005: Mockup fidelity | Phase 4 visual review per view |
| SC-006: Professional rating | User feedback post-release |
